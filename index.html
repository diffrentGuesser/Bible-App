<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FaithFlow Â· clean verse</title>
  <!-- Fonts: sharper, like ChatGPT (Inter + system fallback) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,400;0,14..32,500;0,14..32,600;1,14..32,400&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* modern reset + clean base */
    * { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --bg: #0a0a0c;
      --surface: #121215;
      --card: #1b1b20;
      --card-hover: #22222a;
      --border: #2c2c34;
      --border-light: #3a3a45;
      --text-main: #eaeef2;
      --text-soft: #bdc3cf;
      --text-muted: #8e95a5;
      --accent: #a48b5e;
      --accent-soft: #c9b585;
      --accent-dim: #5f543c;
      --gold: #b8a06c;
      --gold-soft: #d4be8c;
      --red: #cc5b4a;
      --green: #4c9a7a;
      --sidebar-width: 240px;
      --panel-width: 300px;
      --top-height: 60px;
      --font-sans: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      --font-serif: 'Plus Jakarta Sans', var(--font-sans);  /* clean, modern serif alternative */
      --shadow-lg: 0 10px 25px -5px rgba(0,0,0,0.6);
    }

    html { background: #030305; height: 100%; }
    body {
      height: 100%;
      background: var(--bg);
      font-family: var(--font-sans);
      font-size: 15px;
      line-height: 1.5;
      color: var(--text-main);
      -webkit-font-smoothing: antialiased;
      overflow: hidden;
    }

    /* SHELL: fully expansive, left sidebar + center + right panel */
    #shell {
      display: flex;
      height: 100%;
      width: 100%;
      background: var(--bg);
    }

    /* left sidebar â€“ always visible on desktop */
    #sidebar {
      width: var(--sidebar-width);
      background: var(--surface);
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      padding: 24px 16px;
      flex-shrink: 0;
      gap: 6px;
      overflow-y: auto;
    }

    .logo {
      font-family: var(--font-serif);
      font-size: 24px;
      font-weight: 600;
      letter-spacing: -0.02em;
      padding: 8px 12px 24px 12px;
      color: var(--gold-soft);
    }
    .logo span { color: var(--text-main); font-weight: 400; }

    .side-btn {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 12px 14px;
      border-radius: 12px;
      border: none;
      background: transparent;
      color: var(--text-soft);
      font-family: var(--font-sans);
      font-size: 15px;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.15s, color 0.15s;
      width: 100%;
      text-align: left;
    }
    .side-btn svg { width: 20px; height: 20px; stroke: currentColor; stroke-width: 1.8; fill: none; }
    .side-btn:hover { background: rgba(200,180,140,0.08); color: var(--text-main); }
    .side-btn.active {
      background: rgba(180, 150, 100, 0.15);
      color: var(--gold-soft);
    }

    /* center pane â€“ grows, but with max-width on content for readability */
    #pane {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      background: var(--bg);
      min-width: 320px;
      max-width: 780px;  /* comfortable reading width on huge screens */
      border-right: 1px solid var(--border);
    }

    #topbar {
      height: var(--top-height);
      padding: 0 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid var(--border);
      background: var(--surface);
      flex-shrink: 0;
    }
    .page-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-main);
      letter-spacing: -0.01em;
    }
    .app-logo-mobile { display: none; } /* hidden on desktop */

    /* pages container */
    #pages {
      flex: 1;
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: var(--border) transparent;
      padding: 8px 16px 20px 16px;
    }
    #pages::-webkit-scrollbar { width: 5px; }
    #pages::-webkit-scrollbar-thumb { background: var(--border); border-radius: 8px; }

    .page {
      display: none;
      flex-direction: column;
      gap: 12px;
    }
    .page.active { display: flex; }

    /* right panel â€“ always visible when width > 1100px */
    #panel {
      width: var(--panel-width);
      background: var(--surface);
      border-left: 1px solid var(--border);
      flex-shrink: 0;
      padding: 28px 20px;
      overflow-y: auto;
      display: none;
      flex-direction: column;
      gap: 24px;
    }

    /* responsive breakpoints */
    @media (min-width: 1000px) {
      #panel { display: flex; }
    }
    /* mobile tabbar hidden on desktop */
    #tabbar {
      display: none;
      height: 64px;
      background: var(--surface);
      border-top: 1px solid var(--border);
    }

    /* ----- components (clean, ChatGPT-like) ----- */
    .section-label {
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      color: var(--text-muted);
      padding: 16px 6px 4px 6px;
    }

    /* cards */
    .verse-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 20px 20px 16px;
      transition: border-color 0.15s, background 0.15s;
    }
    .verse-card:hover { border-color: var(--border-light); background: var(--card-hover); }
    .verse-text {
      font-family: var(--font-serif);
      font-size: 16px;
      font-weight: 500;
      line-height: 1.6;
      color: var(--text-main);
      margin-bottom: 8px;
    }
    .verse-ref {
      font-size: 12px;
      font-weight: 500;
      color: var(--gold-soft);
      letter-spacing: 0.01em;
    }
    .card-actions {
      display: flex;
      gap: 12px;
      margin-top: 16px;
      padding-top: 12px;
      border-top: 1px solid var(--border);
    }
    .action-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: none;
      border: none;
      color: var(--text-soft);
      font-size: 13px;
      font-weight: 500;
      padding: 6px 12px;
      border-radius: 30px;
      cursor: pointer;
      transition: background 0.15s, color 0.15s;
    }
    .action-btn svg { width: 16px; height: 16px; }
    .action-btn:hover { background: rgba(255,255,240,0.06); color: var(--text-main); }
    .action-btn.saved { color: #e07a9c; }

    /* daily hero */
    .daily-hero {
      background: linear-gradient(145deg, #19171c, #1f1b1f);
      border: 1px solid var(--border-light);
      border-radius: 24px;
      padding: 28px 26px;
      margin-bottom: 8px;
    }
    .daily-label {
      display: flex;
      gap: 8px;
      align-items: center;
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 0.1em;
      color: var(--gold-soft);
      margin-bottom: 16px;
    }
    .daily-label::before { content: 'âœ¦'; font-size: 16px; }
    .daily-text {
      font-family: var(--font-serif);
      font-size: 22px;
      font-weight: 500;
      line-height: 1.5;
      color: var(--text-main);
      margin-bottom: 12px;
    }
    .daily-ref { font-size: 14px; color: var(--gold-soft); font-weight: 500; }
    .pill-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 24px;
    }
    .pill {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 18px;
      background: rgba(180,150,100,0.08);
      border: 1px solid var(--border-light);
      border-radius: 40px;
      font-size: 13px;
      font-weight: 500;
      color: var(--text-soft);
      cursor: pointer;
      transition: background 0.15s;
    }
    .pill:hover { background: rgba(180,150,100,0.16); }
    .pill.saved { color: #e07a9c; border-color: #9f6b7a; }

    /* reel */
    #reel-wrap {
      height: 100%;
      overflow-y: scroll;
      scroll-snap-type: y mandatory;
      scrollbar-width: none;
    }
    .reel-slide {
      min-height: 100%;
      scroll-snap-align: start;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 24px 20px 50px;
      text-align: center;
    }
    .reel-book {
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 0.1em;
      color: var(--text-muted);
      margin-bottom: 16px;
    }
    .reel-verse {
      font-family: var(--font-serif);
      font-size: 24px;
      font-weight: 500;
      line-height: 1.6;
      max-width: 600px;
      margin-bottom: 16px;
    }
    .reel-ref {
      font-size: 14px;
      font-weight: 500;
      color: var(--gold-soft);
      margin-bottom: 28px;
    }
    .reel-actions {
      display: flex;
      gap: 28px;
      justify-content: center;
    }
    .reel-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
      background: none;
      border: none;
      color: var(--text-soft);
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
    }
    .reel-btn svg { width: 26px; height: 26px; }
    .reel-btn.saved { color: #e07a9c; }

    /* game */
    .game-header {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 16px 22px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .score-box { line-height: 1.3; }
    .score-label { font-size: 11px; color: var(--text-muted); }
    .score-number { font-size: 32px; font-weight: 700; color: var(--gold-soft); }
    .streak-badge {
      background: #6b4f3c;
      border-radius: 30px;
      padding: 6px 15px;
      font-weight: 600;
      color: #fae6c0;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .game-verse-box {
      background: var(--card);
      border: 1px solid var(--border-light);
      border-radius: 20px;
      padding: 28px 22px;
      text-align: center;
    }
    .phase-label {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-muted);
      margin: 8px 0 12px;
    }
    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .opt {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 14px 18px;
      font-size: 15px;
      font-weight: 500;
      text-align: left;
      cursor: pointer;
      transition: all 0.1s;
    }
    .opt:hover { border-color: var(--border-light); background: var(--card-hover); }
    .opt.correct { border-color: var(--green); background: rgba(76, 154, 122, 0.15); color: #b7e3cf; }
    .opt.wrong   { border-color: var(--red); background: rgba(204, 91, 74, 0.15); color: #f4b5a9; }
    .feedback {
      padding: 14px 18px;
      border-radius: 16px;
      font-weight: 500;
      display: none;
    }
    .feedback.show { display: block; }
    .feedback.good { background: rgba(76, 154, 122, 0.15); color: #b7e3cf; border: 1px solid var(--green); }
    .feedback.bad  { background: rgba(204, 91, 74, 0.15); color: #f4b5a9; border: 1px solid var(--red); }
    .primary-btn {
      background: var(--gold-soft);
      color: #121212;
      font-weight: 700;
      padding: 16px;
      border: none;
      border-radius: 30px;
      font-size: 16px;
      cursor: pointer;
      transition: opacity 0.1s;
    }
    .primary-btn:disabled { opacity: 0.3; cursor: default; }

    /* profile & empty */
    .profile-hero {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 26px;
      padding: 28px;
      text-align: center;
    }
    .avatar {
      width: 70px; height: 70px;
      border-radius: 50%;
      background: var(--accent-dim);
      margin: 0 auto 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      color: #eee;
    }
    .profile-name { font-size: 22px; font-weight: 600; }
    .profile-sub { color: var(--text-muted); font-size: 13px; }
    .stat-row {
      display: flex;
      gap: 12px;
    }
    .stat-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 16px;
      flex: 1;
      text-align: center;
    }
    .stat-num { font-size: 28px; font-weight: 700; color: var(--gold-soft); line-height: 1; }
    .stat-label { font-size: 10px; color: var(--text-muted); }

    .menu-item {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 14px 16px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 14px;
      margin-bottom: 6px;
      cursor: pointer;
    }
    .empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 50px 20px;
      color: var(--text-muted);
      text-align: center;
    }

    /* overlay */
    .overlay {
      position: fixed; inset: 0;
      background: rgba(0,0,0,0.8);
      backdrop-filter: blur(8px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 200;
    }
    .sheet {
      width: 90%;
      max-width: 440px;
      background: var(--surface);
      border-radius: 32px;
      padding: 32px;
      border: 1px solid var(--border-light);
    }
    .field { margin-bottom: 16px; }
    .field label { font-size: 11px; color: var(--text-muted); }
    .field input {
      width: 100%;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 14px;
      color: white;
      font-size: 15px;
      outline: none;
    }
    .toast {
      position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
      background: var(--card-hover);
      border: 1px solid var(--border-light);
      color: var(--gold-soft);
      padding: 12px 28px;
      border-radius: 50px;
      font-weight: 500;
      z-index: 300;
      transition: opacity 0.2s;
      opacity: 0;
      pointer-events: none;
    }
    .toast.show { opacity: 1; }
    .pts-popup {
      position: fixed; top: 45%; left: 50%; transform: translate(-50%,-50%) scale(0.8);
      background: var(--surface);
      border: 2px solid var(--gold);
      border-radius: 40px;
      padding: 30px 50px;
      text-align: center;
      transition: transform 0.25s;
      z-index: 400;
    }
    .pts-popup.show { transform: translate(-50%,-50%) scale(1); }
    .pts-number { font-size: 56px; font-weight: 800; color: var(--gold-soft); }
  </style>
</head>
<body>
<div id="shell">
  <!-- SIDEBAR (desktop, always visible) -->
  <div id="sidebar">
    <div class="logo">Faith<span>Flow</span></div>
    <button class="side-btn active" data-tab="home"><svg viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9,22 9,12 15,12 15,22"/></svg>Home</button>
    <button class="side-btn" data-tab="verses"><svg viewBox="0 0 24 24"><path d="M4 19.5A2.5 2.5 0 016.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 014 19.5v-15A2.5 2.5 0 016.5 2z"/></svg>Verses</button>
    <button class="side-btn" data-tab="favourites"><svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/></svg>Saved</button>
    <button class="side-btn" data-tab="game"><svg viewBox="0 0 24 24"><rect x="2" y="6" width="20" height="12" rx="3"/><path d="M12 12h.01M17 12h.01M7 10v4M5 12h4"/></svg>Game</button>
    <button class="side-btn" data-tab="profile"><svg viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>Profile</button>
  </div>

  <!-- CENTER PANE -->
  <div id="pane">
    <div id="topbar">
      <div class="app-logo-mobile"></div>
      <span class="page-title" id="topbar-title">Home</span>
      <div style="width:20px"></div>
    </div>

    <div id="pages">
      <!-- HOME -->
      <div class="page active" id="page-home">
        <div class="daily-hero">
          <div class="daily-label">Verse of the day</div>
          <div class="daily-text" id="daily-text">â€¦</div>
          <div class="daily-ref" id="daily-ref">â€”</div>
          <div class="pill-group">
            <button class="pill" id="daily-fav-btn"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" id="daily-fav-svg"><path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/></svg> <span id="daily-fav-label">Save</span></button>
            <button class="pill" id="daily-share-btn"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M4 12v8a2 2 0 002 2h12a2 2 0 002-2v-8M16 6l-4-4-4 4M12 2v13"/></svg>Share</button>
          </div>
        </div>
        <div class="section-label">TRENDING</div>
        <div id="trending-list"></div>
      </div>

      <!-- VERSES REEL -->
      <div class="page" id="page-verses">
        <div id="reel-wrap"></div>
      </div>

      <!-- FAVOURITES -->
      <div class="page" id="page-favourites">
        <div class="section-label">SAVED VERSES</div>
        <div id="fav-list"></div>
      </div>

      <!-- GAME -->
      <div class="page" id="page-game">
        <div class="game-header">
          <div class="score-box"><span class="score-label">POINTS</span><div class="score-number" id="game-score">0</div></div>
          <div class="streak-badge" id="streak-badge" style="display:none">ðŸ”¥ <span id="streak-n">0</span></div>
        </div>
        <div class="game-verse-box">
          <div class="verse-text" id="g-verse-text">Press start</div>
        </div>
        <div class="phase-label" id="g-phase"></div>
        <div class="options" id="g-options"></div>
        <div class="feedback" id="g-feedback"></div>
        <button class="primary-btn" id="g-next">New verse â†’</button>
      </div>

      <!-- PROFILE -->
      <div class="page" id="page-profile">
        <div class="profile-hero">
          <div class="avatar" id="p-avatar">âœ¦</div>
          <div class="profile-name" id="p-name">Guest</div>
          <div class="profile-sub" id="p-sub">Sign in to save</div>
        </div>
        <div class="stat-row">
          <div class="stat-card"><span class="stat-num" id="stat-points">0</span><span class="stat-label">Points</span></div>
          <div class="stat-card"><span class="stat-num" id="stat-favs">0</span><span class="stat-label">Saved</span></div>
          <div class="stat-card"><span class="stat-num" id="stat-streak">0</span><span class="stat-label">Streak</span></div>
        </div>
        <div class="menu-item" id="menu-login"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M15 3h4a2 2 0 012 2v14a2 2 0 01-2 2h-4M10 17l5-5-5-5M15 12H3"/></svg> Sign in / Register</div>
        <div class="menu-item" id="menu-logout" style="display:none"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9"/></svg> Sign out</div>
        <div class="menu-item" id="menu-go-favs"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/></svg> Saved verses <span id="fav-count-menu">0</span></div>
        <div class="menu-item" id="menu-go-game"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="2" y="6" width="20" height="12" rx="3"/><path d="M12 12h.01M17 12h.01M7 10v4M5 12h4"/></svg> Play trivia</div>
      </div>
    </div>

    <!-- mobile tabbar hidden on desktop -->
    <nav id="tabbar"></nav>
  </div>

  <!-- RIGHT PANEL (wide) -->
  <div id="panel">
    <div style="background:var(--card); border-radius:20px; padding:20px;">
      <div style="font-weight:600; margin-bottom:14px;">Quick verses</div>
      <div id="panel-quick" style="display:flex; flex-direction:column; gap:16px;"></div>
    </div>
    <div style="color:var(--text-muted); font-size:13px; line-height:1.7; padding:0 8px;">FaithFlow â€” clean scripture, daily.</div>
  </div>
</div>

<!-- auth overlay & toasts -->
<div class="overlay" id="auth-overlay">
  <div class="sheet">
    <h2 id="auth-title" style="margin-bottom:20px;">Welcome</h2>
    <div class="field"><label>Email</label><input id="auth-email" type="email"></div>
    <div class="field"><label>Password</label><input id="auth-pass" type="password"></div>
    <div class="field" id="auth-name-wrap" style="display:none"><label>Name</label><input id="auth-name"></div>
    <button class="primary-btn" id="auth-submit">Continue</button>
    <div style="margin-top:14px;font-size:13px;color:var(--text-muted);text-align:center"><a id="auth-toggle" style="color:var(--gold);cursor:pointer;">Switch to register</a></div>
    <button style="margin-top:12px;background:none;border:none;color:var(--text-muted);float:right" id="auth-close">âœ•</button>
  </div>
</div>
<div class="toast" id="toast"></div>
<div class="pts-popup" id="pts-popup"><div class="pts-number" id="pts-amount">+5</div><div style="color:var(--text-soft)">earned</div></div>

<script>
  (function(){
    // ---- embedded verses (NIV like) same as original but cleaner ----
    const VERSES = [
      { text:"For God so loved the world that he gave his one and only Son, that whoever believes in him shall not perish but have eternal life.", ref:"John 3:16", book:"John", ch:3, v:16, t:"NT" },
      { text:"I can do all this through him who gives me strength.", ref:"Philippians 4:13", book:"Philippians", ch:4, v:13, t:"NT" },
      { text:"The Lord is my shepherd, I lack nothing.", ref:"Psalms 23:1", book:"Psalms", ch:23, v:1, t:"OT" },
      { text:"Trust in the Lord with all your heart and lean not on your own understanding.", ref:"Proverbs 3:5", book:"Proverbs", ch:3, v:5, t:"OT" },
      { text:"Be strong and courageous. Do not be afraid; do not be discouraged, for the Lord your God will be with you wherever you go.", ref:"Joshua 1:9", book:"Joshua", ch:1, v:9, t:"OT" },
      { text:"And we know that in all things God works for the good of those who love him, who have been called according to his purpose.", ref:"Romans 8:28", book:"Romans", ch:8, v:28, t:"NT" },
      { text:"Do not be anxious about anything, but in every situation, by prayer and petition, with thanksgiving, present your requests to God.", ref:"Philippians 4:6", book:"Philippians", ch:4, v:6, t:"NT" },
      { text:"For I know the plans I have for you, declares the Lord, plans to prosper you and not to harm you, plans to give you hope and a future.", ref:"Jeremiah 29:11", book:"Jeremiah", ch:29, v:11, t:"OT" },
      { text:"Come to me, all you who are weary and burdened, and I will give you rest.", ref:"Matthew 11:28", book:"Matthew", ch:11, v:28, t:"NT" },
      { text:"Love is patient, love is kind. It does not envy, it does not boast, it is not proud.", ref:"1 Corinthians 13:4", book:"1 Corinthians", ch:13, v:4, t:"NT" },
      { text:"The Lord is my light and my salvationâ€”whom shall I fear?", ref:"Psalms 27:1", book:"Psalms", ch:27, v:1, t:"OT" },
      { text:"But those who hope in the Lord will renew their strength. They will soar on wings like eagles.", ref:"Isaiah 40:31", book:"Isaiah", ch:40, v:31, t:"OT" },
      { text:"This is the day the Lord has made; let us rejoice and be glad in it.", ref:"Psalms 118:24", book:"Psalms", ch:118, v:24, t:"OT" },
      { text:"Greater love has no one than this: to lay down one's life for one's friends.", ref:"John 15:13", book:"John", ch:15, v:13, t:"NT" },
      { text:"Cast all your anxiety on him because he cares for you.", ref:"1 Peter 5:7", book:"1 Peter", ch:5, v:7, t:"NT" },
      { text:"Even though I walk through the darkest valley, I will fear no evil, for you are with me.", ref:"Psalms 23:4", book:"Psalms", ch:23, v:4, t:"OT" },
      { text:"For the Spirit God gave us does not make us timid, but gives us power, love and self-discipline.", ref:"2 Timothy 1:7", book:"2 Timothy", ch:1, v:7, t:"NT" },
      { text:"The steadfast love of the Lord never ceases; his mercies never come to an end; they are new every morning.", ref:"Lamentations 3:22-23", book:"Lamentations", ch:3, v:22, t:"OT" },
      { text:"Ask and it will be given to you; seek and you will find; knock and the door will be opened to you.", ref:"Matthew 7:7", book:"Matthew", ch:7, v:7, t:"NT" },
      { text:"I have hidden your word in my heart that I might not sin against you.", ref:"Psalms 119:11", book:"Psalms", ch:119, v:11, t:"OT" },
      { text:"Be still, and know that I am God.", ref:"Psalms 46:10", book:"Psalms", ch:46, v:10, t:"OT" },
      { text:"If God is for us, who can be against us?", ref:"Romans 8:31", book:"Romans", ch:8, v:31, t:"NT" },
      { text:"He gives strength to the weary and increases the power of the weak.", ref:"Isaiah 40:29", book:"Isaiah", ch:40, v:29, t:"OT" },
      { text:"Delight yourself in the Lord, and he will give you the desires of your heart.", ref:"Psalms 37:4", book:"Psalms", ch:37, v:4, t:"OT" },
      { text:"Jesus answered, 'I am the way and the truth and the life. No one comes to the Father except through me.'", ref:"John 14:6", book:"John", ch:14, v:6, t:"NT" }
    ];
    const OT_BOOKS = ['Genesis','Exodus','Leviticus','Numbers','Deuteronomy','Joshua','Judges','Ruth','1 Samuel','2 Samuel','1 Kings','2 Kings','Isaiah','Jeremiah','Lamentations','Ezekiel','Daniel','Hosea','Joel','Amos','Jonah','Psalms','Proverbs','Ecclesiastes'];
    const NT_BOOKS = ['Matthew','Mark','Luke','John','Acts','Romans','1 Corinthians','2 Corinthians','Galatians','Ephesians','Philippians','Colossians','1 Thessalonians','2 Thessalonians','1 Timothy','2 Timothy','Titus','Philemon','Hebrews','James','1 Peter','2 Peter','1 John','2 John','3 John','Jude','Revelation'];

    // state
    let ST = { user:null, users:{}, favs:[], score:0, streak:0 };
    try { let s=localStorage.getItem('ff_clean'); if(s) ST=JSON.parse(s); } catch{}
    function save(){ localStorage.setItem('ff_clean',JSON.stringify(ST)); }

    // helpers
    function isFav(ref){ return ST.favs.some(f=>f.ref===ref); }
    function toggleFav(v){ 
      if(isFav(v.ref)) ST.favs = ST.favs.filter(f=>f.ref!==v.ref);
      else ST.favs.unshift({ref:v.ref,text:v.text,book:v.book,ch:v.ch,v:v.v,t:v.t});
      save(); updateFavCount(); renderFavs(); refreshUI(); 
    }
    function updateFavCount(){
      let n=ST.favs.length;
      document.getElementById('stat-favs').textContent=n;
      let m=document.getElementById('fav-count-menu'); if(m) m.textContent=n+' verses';
    }
    function showToast(m){ let t=document.getElementById('toast'); t.textContent=m; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'),2000); }
    function shareVerse(text,ref){ let msg=`"${text}" â€” ${ref}`; if(navigator.share) navigator.share({text:msg}); else navigator.clipboard?.writeText(msg).then(()=>showToast('copied')); }

    // tabs
    let current='home';
    function switchTab(t){
      current=t;
      document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
      document.getElementById('page-'+t).classList.add('active');
      document.querySelectorAll('.side-btn').forEach(b=>b.classList.toggle('active',b.dataset.tab===t));
      document.getElementById('topbar-title').innerText=t[0].toUpperCase()+t.slice(1);
      if(t==='verses' && !window.reelBuilt) { buildReel(); window.reelBuilt=true; }
      if(t==='favourites') renderFavs();
      if(t==='profile') updateProfile();
    }
    document.querySelectorAll('[data-tab]').forEach(el=>el.addEventListener('click',()=>switchTab(el.dataset.tab)));

    // daily index
    function dayIdx(){ let d=new Date(); return (d.getFullYear()*1000+d.getMonth()*31+d.getDate())%VERSES.length; }

    // home init
    function initHome(){
      let dv=VERSES[dayIdx()];
      document.getElementById('daily-text').textContent=dv.text;
      document.getElementById('daily-ref').textContent='â€” '+dv.ref;
      refreshDaily();
      document.getElementById('daily-fav-btn').addEventListener('click',()=>{ toggleFav(dv); refreshDaily(); });
      document.getElementById('daily-share-btn').addEventListener('click',()=>shareVerse(dv.text,dv.ref));
      // trending
      let list=document.getElementById('trending-list'); list.innerHTML='';
      [...VERSES].sort(()=>Math.random()-.5).slice(0,5).forEach(v=>list.appendChild(renderVCard(v)));
      // right panel quick
      let q=document.getElementById('panel-quick'); q.innerHTML='';
      [...VERSES].sort(()=>Math.random()-.5).slice(0,3).forEach(v=>{
        let d=document.createElement('div'); d.innerHTML=`<div style="font-style:italic; margin-bottom:4px;">${v.text.slice(0,60)}â€¦</div><div style="color:var(--gold-soft);font-size:11px;">${v.ref}</div>`;
        q.appendChild(d);
      });
    }
    function refreshDaily(){
      let dv=VERSES[dayIdx()]; let f=isFav(dv.ref);
      let svg=document.getElementById('daily-fav-svg'); svg.setAttribute('fill',f?'currentColor':'none');
      document.getElementById('daily-fav-label').innerText=f?'Saved':'Save';
    }
    function renderVCard(v){
      let div=document.createElement('div'); div.className='verse-card';
      div.innerHTML=`<div class="verse-text">${v.text}</div><div class="verse-ref">${v.ref}</div><div class="card-actions"><button class="action-btn fav-act ${isFav(v.ref)?'saved':''}"><svg viewBox="0 0 24 24" fill="${isFav(v.ref)?'currentColor':'none'}" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/></svg> <span>${isFav(v.ref)?'Saved':'Save'}</span></button><button class="action-btn share-act"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M4 12v8a2 2 0 002 2h12a2 2 0 002-2v-8M16 6l-4-4-4 4M12 2v13"/></svg> Share</button></div>`;
      div.querySelector('.fav-act').addEventListener('click',()=>{ toggleFav(v); div.replaceWith(renderVCard(v)); });
      div.querySelector('.share-act').addEventListener('click',()=>shareVerse(v.text,v.ref));
      return div;
    }

    // reel
    function buildReel(){
      let w=document.getElementById('reel-wrap'); w.innerHTML='';
      [...VERSES].sort(()=>Math.random()-.5).forEach((v,i)=>{
        let s=document.createElement('div'); s.className='reel-slide';
        s.innerHTML=`<div class="reel-book">${v.t==='NT'?'NEW TESTAMENT':'OLD TESTAMENT'}</div><div class="reel-verse">${v.text}</div><div class="reel-ref">${v.ref}</div><div class="reel-actions"><button class="reel-btn fav-r"><svg viewBox="0 0 24 24" fill="${isFav(v.ref)?'currentColor':'none'}" stroke="currentColor"><path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/></svg><span>${isFav(v.ref)?'Saved':'Save'}</span></button><button class="reel-btn share-r"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M4 12v8a2 2 0 002 2h12a2 2 0 002-2v-8M16 6l-4-4-4 4M12 2v13"/></svg><span>Share</span></button></div>`;
        s.querySelector('.fav-r').addEventListener('click',()=>{ toggleFav(v); buildReel(); });
        s.querySelector('.share-r').addEventListener('click',()=>shareVerse(v.text,v.ref));
        w.appendChild(s);
      });
    }

    // favourites render
    function renderFavs(){
      let list=document.getElementById('fav-list'); list.innerHTML='';
      if(!ST.favs.length) list.innerHTML='<div class="empty-state">âœ¦ no saved verses</div>';
      else ST.favs.forEach(v=>list.appendChild(renderVCard(v)));
    }

    // game (simplified)
    let gV=null, gPhase=0, gScoreRound=0, gDone=true;
    function gameNext(){
      if(gDone){
        gV=VERSES[Math.floor(Math.random()*VERSES.length)];
        gPhase=1; gScoreRound=0; gDone=false;
        document.getElementById('g-verse-text').innerText=gV.text;
        hideFB(); renderGamePhase();
        document.getElementById('g-next').disabled=true;
        document.getElementById('g-next').innerText='Skip';
      }
    }
    function renderGamePhase(){
      let opts=[];
      if(gPhase===1) opts=['Old Testament','New Testament'];
      else if(gPhase===2){ let pool=gV.t==='NT'?NT_BOOKS:OT_BOOKS; opts=[gV.book, ...pool.filter(b=>b!==gV.book).sort(()=>Math.random()-.5).slice(0,3)]; }
      else if(gPhase===3){ let c=gV.ch; opts=[c,c+1,c-1,c+2].filter(x=>x>0&&x!==c).slice(0,3); opts=[c,...opts]; }
      document.getElementById('g-phase').innerText=gPhase===1?'Testament?':gPhase===2?'Which book?':'Chapter?';
      let html=''; opts.sort(()=>Math.random()-.5).forEach(o=>html+=`<div class="opt" data-opt="${o}">${o}</div>`);
      document.getElementById('g-options').innerHTML=html;
      document.querySelectorAll('.opt').forEach(b=>b.addEventListener('click',()=>handleGuess(b.dataset.opt,opts)));
    }
    function handleGuess(choice,all){
      let correct=false, ans='';
      if(gPhase===1){ let exp=gV.t==='NT'?'New Testament':'Old Testament'; correct=(choice===exp); ans=exp; }
      else if(gPhase===2){ correct=(choice===gV.book); ans=gV.book; }
      else { correct=(Number(choice)===gV.ch); ans=gV.ch; }
      document.querySelectorAll('.opt').forEach(b=>{ b.style.pointerEvents='none'; if(b.dataset.opt==ans) b.classList.add('correct'); else if(b.dataset.opt==choice && !correct) b.classList.add('wrong'); });
      if(correct){
        gScoreRound++; 
        if(gPhase===3){
          let bonus=gScoreRound*2; ST.score+=bonus; ST.streak++; showToast('ðŸŽ‰ +'+bonus); gDone=true;
          document.getElementById('g-next').disabled=false; document.getElementById('g-next').innerText='Next';
        } else { showFeedback('âœ“ correct','good'); setTimeout(()=>{ gPhase++; hideFB(); renderGamePhase(); },700); }
      } else {
        ST.score+=gScoreRound; ST.streak=0; gDone=true;
        document.getElementById('g-next').disabled=false; document.getElementById('g-next').innerText='Next';
        showFeedback('âœ— '+ans,'bad'); if(gScoreRound>0) showToast('+'+gScoreRound);
      }
      save(); updateScore();
    }
    function showFeedback(m,t){ let f=document.getElementById('g-feedback'); f.textContent=m; f.className='feedback show '+t; }
    function hideFB(){ document.getElementById('g-feedback').className='feedback'; }
    function updateScore(){ document.getElementById('game-score').textContent=ST.score; document.getElementById('stat-points').textContent=ST.score; }
    document.getElementById('g-next').addEventListener('click',gameNext);

    // profile/auth
    function updateProfile(){
      if(ST.user){ document.getElementById('p-avatar').innerText=ST.user.name[0]; document.getElementById('p-name').innerText=ST.user.name; document.getElementById('p-sub').innerText=ST.user.email; }
      else { document.getElementById('p-avatar').innerText='âœ¦'; document.getElementById('p-name').innerText='Guest'; document.getElementById('p-sub').innerText='sign in'; }
      document.getElementById('stat-points').textContent=ST.score; document.getElementById('stat-favs').textContent=ST.favs.length; document.getElementById('stat-streak').textContent=ST.streak;
    }
    document.getElementById('menu-login').addEventListener('click',()=>document.getElementById('auth-overlay').classList.add('show'));
    document.getElementById('auth-close').addEventListener('click',()=>document.getElementById('auth-overlay').classList.remove('show'));
    // minimal auth simulation
    document.getElementById('auth-submit').addEventListener('click',()=>{ ST.user={email:'demo@f',name:'Demo'}; save(); updateProfile(); document.getElementById('auth-overlay').classList.remove('show'); showToast('signed in'); });
    document.getElementById('menu-go-favs').addEventListener('click',()=>switchTab('favourites'));
    document.getElementById('menu-go-game').addEventListener('click',()=>switchTab('game'));

    // boot
    initHome(); updateScore(); updateFavCount(); updateProfile(); window.reelBuilt=false;
  })();
</script>
</body>
</html>